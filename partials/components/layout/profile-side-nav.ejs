<% 

  var nav = [
    {
      text: "My details",
      link: "/auth/profile/"
    },
    {
      text: "Service history",
      link: "/auth/profile/history"
    },
    {
      text: "Payment destination",
      link: "/auth/profile/payment"
    },
    {
      text: "Representation",
      link: "/auth/profile/nomrep"
    },
    {
      text: "Cards",
      link: "/auth/profile/cards"
    },
    {
      text: "Correspondence",
      link: "/auth/profile/correspondence"
    },
    {
      text: "Commemoration",
      link: "/auth/profile/commemoration"
    }
  ]

  function isActive(link) {
    if (source_url.substr(-1) === "") source_url = source_url.slice(0, -1);
    source_url = source_url.replace(".ejs", "");
    if (link === "/auth/profile/") {
      if (source_url === "/auth/profile/" || source_url === "/auth/profile/index") return true
    } else {
      return source_url.includes(link)
    }
  }

  function getPage(){
    for ( var i = 0; i < nav.length; i++) {
      var obj = nav[i];
      if ( obj.link == source_url ) return obj.text
    }
  }

%>

<div class="back-button">
  <a href="/auth" class="mys h5"><i class="fal fa-arrow-left fa-fw"></i>Back to home</a>
</div>
<button class="mobile-menu"><%- getPage() %><i class="fal fa-angle-down"></i></button>
<ul class="secondary-navigation">
  <% nav.forEach(item => { %>
  <li class="secondary-navigation__item <%- isActive(item.link) ? "secondary-navigation__item--active" : "" %>">
    <a href="<%- item.link %>" class="secondary-navigation__link"><%- item.text %></a>
  </li>
  <% }) %>
</ul>

<script>
  $(".mobile-menu").on("click", function () {
    $(".secondary-navigation").toggle();
    $(".mobile-menu").toggleClass("menu-open");
  });
</script>